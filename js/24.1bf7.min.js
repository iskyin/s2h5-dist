(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{104:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return R}));t(319);var a=t(139),o=(t(633),t(632)),r=(t(537),t(536)),l=t(42),c=t.n(l),i=t(41),s=t.n(i),u=(t(320),t(140)),d=t(614),f=t.n(d),m=t(45),p=t.n(m),h=t(46),v=t.n(h),g=t(47),y=t.n(g),b=t(48),w=t.n(b),F=t(317),x=t.n(F),k=t(49),E=t.n(k),O=t(73),j=t.n(O),A=t(0),C=t.n(A),D=t(36),I=t(31),L=t(50),R=function(e){function n(){var e,t;p()(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return t=y()(this,(e=w()(n)).call.apply(e,[this].concat(o))),j()(x()(t),"form",null),j()(x()(t),"getFormRef",(function(e){t.form=e})),j()(x()(t),"handleOnFileChange",(function(e){return Array.isArray(e)?e:e&&e.fileList})),j()(x()(t),"onSubmit",function(){var e=f()(s.a.mark((function e(n){var a,o,r,l,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.form){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.form.validateFields();case 5:for(a=e.sent,console.log("succes:",a),o={},r=0,l=Object.keys(a);r<l.length;r++)c=l[r],o[c]=(a[c]||[]).filter((function(e){return"done"===e.status})).map((function(e){return e.response.data}));console.log("最终:",o),Object(L.a)(D.a.addOtherDocument).post(o).then((function(e){var t="保存成功！";"remove"===n&&(t="删除成功！"),u.a.success(t)})),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),u.a.error("保存失败！"),console.log("Failed:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(n){return e.apply(this,arguments)}}()),j()(x()(t),"removeFile",(function(e){if(console.log("删除",e),"done"!==e.status)return!1;var n=e.response.data.id;Object(L.a)(D.a.deleteAnnex).post({id:n}).then((function(e){return t.onSubmit("remove"),!0})).catch((function(e){return u.a.error("删除失败，请联系管理员"),console.log("Error:",e),!1}))})),j()(x()(t),"changeFile",(function(e){"done"===e.file.status&&(console.log("添加",e.file,e.fileList),t.onSubmit())})),t}return E()(n,e),v()(n,[{key:"componentDidMount",value:function(){var e=this;Object(L.a)(D.a.getOtherDocument).get(null,!0).then((function(n){for(var t={},a=0,o=Object.keys(n||{});a<o.length;a++){var r=o[a];n[r]&&"object"===c()(n[r])&&(console.log("res[param]",n[r]),t[r]=(n[r]||[]).map((function(e){return{uid:"-"+e.id,name:e.annexName,status:"done",response:{data:e}}})))}e.form&&(console.log("获取的数据",t),e.form.setFieldsValue(t))})).catch((function(e){u.a.error("获取页面数据失败，请联系管理员"),console.log("Error:",e)}))}},{key:"downloadFile",value:function(e){var n=e.response.data.id;Object(L.a)(D.a.downloadAnnex).downloadFile({id:n})}},{key:"render",value:function(){var e=this,n=[],t=!0,l=!1,c=void 0;try{for(var i,s=Object.keys(I.e).slice(0,5)[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var u=i.value;n.push(I.e[u])}}catch(e){l=!0,c=e}finally{try{t||null==s.return||s.return()}finally{if(l)throw c}}return C.a.createElement("article",{className:"content-box",style:{alignItems:"center"}},C.a.createElement(a.a,{ref:this.getFormRef,labelCol:{span:10}},n.map((function(n){var t=n.annexType,l=n.label,c=n.name;return C.a.createElement(a.a.Item,{key:t,label:l,name:c,valuePropName:"fileList",getValueFromEvent:e.handleOnFileChange},C.a.createElement(o.a,{action:D.a.uploadAnnex,onDownload:e.downloadFile,onRemove:e.removeFile,onChange:e.changeFile,name:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.csv",data:{annexType:t},headers:{Authorization:Object(L.e)("Authorization")||""},showUploadList:{showRemoveIcon:!0,removeIcon:C.a.createElement("span",{style:{color:"#FF4949"}},"删除"),downloadIcon:C.a.createElement("span",null,C.a.createElement("span",{style:{color:"#367DFF"}},"下载"),C.a.createElement("span",{style:{color:"#3C3C3C"}}," | ")),showDownloadIcon:!0},defaultFileList:[],iconRender:null},C.a.createElement(r.a,null,"点击上传文件")))}))))}}]),n}(C.a.Component)}}]);